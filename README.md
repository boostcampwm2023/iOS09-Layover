# iOS09-Layover
---
## 프로젝트 소개

<p align="center">
    <img src="https://github.com/boostcampwm2023/iOS09-Layover/assets/46420281/525b6629-8e2e-42a1-b665-e1a9b04e17cf" width=20% />
</p>
<p align="center">
    Layover는 5초에서 60초의 짧은 영상을 위치기반으로 기록하고 공유하는 플랫폼입니다. 
</p>
    
    유저들은 지구를 여행하는 여행자가 되어 자신의 여정을 간편하고 직관적인 방식으로 기록하고, 
    
    다양한 장소들의 대한 영상을 다른 유저들과 공유하고, 감상할 수 있습니다.
    
    어디서든 간편하게 Layover를 통해 방문의 순간, 기억을 지도에 기록하고, 다양한 경험을 나눌 수 있습니다. 
    
    당신의 여정을 Layover에 쌓아가보세요!
---
## 문서

| 그라운드 룰                                                                           | 기획/디자인 | 템플릿 | 회의록 | ***개발일지*** |
| ------------------------------------------------------------------------------------- | ---------------- | ------ | ------ | ------ |
| ⛳️ [그라운드 룰](https://loinsir.notion.site/51835aceabde449a82b56f7c15353a98?pvs=4) | 🎨 [디자인](https://www.figma.com/file/wqUKtYD2tqY6qS0TZnw2eO/Layover-UI?type=design&mode=design&t=9Io4sVa1Q17CxICu-1)             | 🔭 [템플릿](https://loinsir.notion.site/084324b5761c4d38bfd69a102e525d97?pvs=4)|📝 [회의록](https://loinsir.notion.site/2132e55f2dfd4f83ad895aabeab41684?pvs=4)| 🛠️ [DevLog](https://loinsir.notion.site/Dev-Log-346d2f9ee4c64869a7a25d350761c4a9?pvs=4)

---
## 팀원 소개

<table align=center>
    <thead>
        <tr >
            <th style="text-align:center;" >🍎 김인환</th>
            <th style="text-align:center;" >🍎 안유경</th>
            <th style="text-align:center;" >🍎 황지웅</th>
            <th style="text-align:center;" >🌐 박지환</th>
            <th style="text-align:center;" >🌐 백종인</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><img width="200" src="https://github.com/boostcampwm2023/iOS09-Layover/assets/46420281/3b3d1134-79f6-4b04-8ad3-78ffbc56dec9" /> </td>
            <td><img width="200" src="https://avatars.githubusercontent.com/u/70168249?v=4" /></td>
            <td><img width="200" src="https://avatars.githubusercontent.com/u/44396392?v=4" /></td>
            <td><img width="200" src="https://avatars.githubusercontent.com/u/111403658?v=4" /></td>
            <td><img width="200" src="https://avatars.githubusercontent.com/u/75191916?v=4" /></td>
        </tr>
        <tr>
            <td><a href="https://github.com/loinsir">@loinsir</a></td>
            <td><a href="https://github.com/anyukyung">@anyukyung</a></td>
            <td><a href="https://github.com/chopmozzi">@chopmozzi</a></td>
            <td><a href="https://github.com/hw-ani">@hw-ani</a></td>
            <td><a href="https://github.com/whipbaek">@whipbaek</a></td>
        </tr>
        <tr>
            <td>환1에요,,ㅎ</td>
            <td>콩이에요,,ㅎ</td>
            <td>웅이에요,,ㅎ</td>
            <td>환2에요,,,,,,ㅎ</td>
            <td>몰?루</td>
        </tr>
        <tr>
            <td width="200"><b>Write Reasonable Code!</b><br/>이유 있는 코드를 작성하기</td>
            <td width="200"><b>🏊‍♂️ DEEP DIVE</b><br/>함께 성장하기<br/>재밌게 하기<br/>꼼꼼한 코드리뷰<br/></td>
            <td width="200"><b>🐢 기본에 충실한</b><br/>서드 파티에 의존하지 않기<br/>Swift를 이용한 기술 도전 많이 하기</td>
            <td width="200">과정을 즐기기</br>열린 자세로 학습</td>
            <td width="200">영향을 주는 사람 되기 🎱</td>
        </tr>
    </tbody>
</table>

---
## 프로젝트 소개 및 주요 기능

![기획 설명](https://github.com/boostcampwm2023/iOS09-Layover/assets/44396392/0a7c7d57-c513-4dda-8d1a-4396cfaf802d)

### 영상 탐색 및 시청
> 홈에서 랜덤한 영상을 탐색하고, 원하는 영상을 골라 재생할 수 있습니다.

<img src="https://github.com/boostcampwm2023/iOS09-Layover/assets/46420281/2b69de8c-a6b6-45fe-94db-5c0f0da3795d" width=20% />
<img src="https://github.com/boostcampwm2023/iOS09-Layover/assets/46420281/ff21462b-6cc3-4d0d-be8d-e776167ca3f3" width=20% />

### 위치 기반 영상 탐색
> 지도에서 원하는 지역의 영상을 탐색하고, 원하는 영상을 골라 재생할 수 있습니다.

<img src="https://github.com/boostcampwm2023/iOS09-Layover/assets/46420281/38d6ef0e-2d45-4a6d-9c20-90dd2811c1ee" width=20% />

### 영상 편집 및 위치 기반 영상 업로드
> 현재 위치를 기반으로, 간단한 편집 기능과 함께 영상을 업로드 할 수 있습니다.

<img src="https://github.com/boostcampwm2023/iOS09-Layover/assets/46420281/ab1913b8-9eae-4f14-a52e-e6b587eb0d6f" width=20% />
<img src="https://github.com/boostcampwm2023/iOS09-Layover/assets/46420281/cb7fbd48-3009-4a24-bc1f-a47a22b3dcfd" width=20% />

### 프로필
> 프로필에서 내가 업로드한 영상의 목록을 확인하고 재생할 수 있습니다.

<img src="https://github.com/boostcampwm2023/iOS09-Layover/assets/46420281/712f2e27-2ed2-4599-b303-cf1b834c6190" width=20% />

---

## 핵심 기술
### HLS

<p align="center">
    <img src="https://github.com/boostcampwm2023/iOS09-Layover/assets/46420281/7c7c1526-5a61-4bad-ae67-4734734d78ba" width=80% />
</p>

- ABR(Adaptive Bitrate Streaming)를 통해 네트워크, CPU Capacity 상태에 따라 동적으로 화질을 변경하여 최적의 영상 품질을 제공합니다.
- iOS에서 지원하는 유일한 스트리밍 프로토콜 입니다.
---
## 기술스택
### 🍎 iOS
<p>
    <img src="https://img.shields.io/badge/CleanSwift-F05138?style=for-the-badge&logo=swift&logoColor=white">
    <img src="https://img.shields.io/badge/AVFoundation-000000?style=for-the-badge&logo=airplayvideo&logoColor=white">    
    <img src="https://img.shields.io/badge/MapKit-4285F4?style=for-the-badge&logo=googlemaps&logoColor=white">
    <img src="https://img.shields.io/badge/Swift Concurrency-F05138?style=for-the-badge&logo=swift&logoColor=white">
</p>

  
### 🌐 BE

<p>
    <img src="https://img.shields.io/badge/TypeScript-3178C6?style=for-the-badge&logo=typescript&logoColor=white">
    <img src="https://img.shields.io/badge/NestJS-E0234E?style=for-the-badge&logo=NestJS&logoColor=white">    
    <img src="https://img.shields.io/badge/MySQL-4479A1?style=for-the-badge&logo=mysql&logoColor=white">
    <img src="https://img.shields.io/badge/Redis-DC382D?style=for-the-badge&logo=redis&logoColor=white">
    <img src="https://img.shields.io/badge/Docker-2496ED?style=for-the-badge&logo=docker&logoColor=white">
    <img src="https://img.shields.io/badge/Jenkins-D24939?style=for-the-badge&logo=jenkins&logoColor=white">
    <img src="https://img.shields.io/badge/ncloud Service-03C75A?style=for-the-badge&logo=naver&logoColor=white">
</p>

---
## 기술적 도전 (BE)
### 🎞 **presigned URL** 을 통한 업로드 구성
- **`서버 부하 감소`** : Client -> Storage 직접 업로드, 서버의 부하 감소 및 업로드 속도 향상
- **`구현 단순화`** : 단순히 URL을 통하여 업로드 함으로써 iOS, 서버 양쪽의 구현 단순화

![image](https://hackmd.io/_uploads/H16qds_Ia.png)

<br>

### 🎬 **VOD Station** & **Cloud Function** 서비스를 활용한 인코딩 및 스트리밍
- ABR 스트리밍을 위하여 다양한 화질로 인코딩 (SD/HD/FHD) 및 스트리밍
- Serverless 서비스 Cloud Function 을 통한 인코딩 자동화 및 콜백 업데이트

![image](https://hackmd.io/_uploads/HyHJI3_Ua.png)

<br>

### 🔐JWT를 이용한 인증

- JSON Web Token 으로 사용자 인증 진행
-  Redis로 각 토큰의 whitelist/blacklist를 운영하여 JWT 보안 허점 보완

![image](https://hackmd.io/_uploads/BJZjXpuUT.png)

<br>

### 📜 **Server Monitoring**

- 서버에서 로그 저장 및 **`Cloud Log Analytics`** 서비스를 활용한 로그 수집
- Discord Bot 을 적극적으로 활용한 빠른 에러대처
- **`cadvisor + prometheus + grfana`** 을 활용한 서버 모니터링 

![image](https://hackmd.io/_uploads/rk4Wg2u8p.png)

![image](https://hackmd.io/_uploads/HJ73g2dIa.png)


<br>


---
## 아키텍처

### 🍎 iOS

<img width="1229" alt="image" src="https://github.com/boostcampwm2023/iOS09-Layover/assets/46420281/5c0b181f-4e4f-4bc0-9ebc-c49e959a4538">

### 🌐 BE

![image](https://hackmd.io/_uploads/rylDX2OUp.png)


---

## 개발 일지
### 🍎 iOS


| 제목 | Topic |
| -------- | -------- |
| [CleanSwift에 대하여](https://loinsir.notion.site/Clean-Swift-fabd1427e02241a6a8f4f0e18c5fc5fd?pvs=4) | 아키텍처 |
| [코드폭격기 팀에서 적용한 iOS CI](https://loinsir.notion.site/iOS-CI-8eedf4b6aa5542adb67fe454d9d945a8?pvs=4) | CI/CD |
| [앱에서 영상을 재생하기까지의 과정](https://loinsir.notion.site/856f29675c174ac48e8a9e6c0b868036?pvs=4) | AVFoundation |
| [디자인 시스템 만들면서 기록하기](https://loinsir.notion.site/16b4a7c7cb8c4fe3b98748dd570d8b7b?pvs=4) | UI |
| [AVPlayerLayer를 이용해 영상을 재생할 수 있는 PlayerView 구성](https://loinsir.notion.site/AVPlayerLayer-PlayerView-a9a85dac626b40b89551b7f40d0aef79?pvs=4) | AVFoundation |
| [네트워크 통신없이 테스트하기 - URLProtocol](https://loinsir.notion.site/URLProtocol-fe734c0532f0473092f5e24e6a7b65f9?pvs=4) | URLSession |
| [영상 업로드 화면을 만들어보쟈](https://loinsir.notion.site/1af78c8533b441a48e70140564da7ca2?pvs=4) | AVFoundation |
| [제목은 좌충우돌 테스트코드 작성기로 하겠습니다. 그런데 Test Double을 곁들인…](https://loinsir.notion.site/Test-Double-ae17251bf438467bbc55ce686e72677d?pvs=4) | XCTest |
| [MapView의 annotation selection 이슈](https://loinsir.notion.site/MapView-annotation-selection-6d75a520888949189e4a831b50382969?pvs=4) | MapKit
| [테플 올리는거 그냥 과정 정리해보기](https://loinsir.notion.site/4a3dd96c36c9418b8a0206fd7a7f94bb?pvs=4) | TestFlight |
| [영상을 재생시키면서 생긴 문제](https://loinsir.notion.site/102ce8a8cd8d423a9bc3e8ef24eb1267?pvs=4) | AVFoundation |
| [UICollectionView로 무한 스크롤 만들기](https://loinsir.notion.site/UICollectionView-e90cef7c313b4e359231a35d69f5b232?pvs=4) | UIKit |


### 🌐 BE

| 제목 | Topic |
| -------- | -------- |
|[Tech Stack 선정 및 이유](https://www.notion.so/loinsir/Tech-Stack-8f23052d223e4caeb54b0c6aec86ae2d?pvs=4)  |아키텍처  |
|[카카오/애플 OAuth](https://www.notion.so/loinsir/OAuth-785829eb700d4b208272bdd6a377e381?pvs=4)  |OAuth  |
|[HTTPS 설정](https://www.notion.so/loinsir/HTTPS-9dd7c9ba64de482ab7c3d3c4fab8fd3d?pvs=4)  | HTTPS |
|[Custom Response 와 ts-jenum](https://www.notion.so/loinsir/Custom-Exception-ts-jenum-b533ca572a974b5bb5318c5a5ecd223d?pvs=4)  | Response  |
|[NestJS + Jest 테스트코드 작성](https://www.notion.so/loinsir/NestJS-Test-Code-62a0ed938b1a4f6f89f65fa5d0f70702?pvs=4)  | Test  |
|[게시물 Pagination](https://www.notion.so/loinsir/Pagination-f7abb5a0ea334dc1a9e4f78e4516d544?pvs=4)  | Pagination  |
|[HTTP Request Header에 대한 Pipe 구현하기](https://www.notion.so/loinsir/Pipe-0bc76f68b61e4e4ea6aa206b98b5e532?pvs=4) |@Pipe |
|[VOD Station이란? 설정방법](https://www.notion.so/loinsir/VOD-Station-ae3d47bf2c1a4e35be14e6e7c3553dd4?pvs=4) | Video |
|[클라이언트 업로드를 위한 presigned-URL 발급](https://www.notion.so/loinsir/Presigned-URL-03d6a4fc3f7c46dea50c004038bed358?pvs=4) | Video |
|[Serverless 서비스 Cloud Function을 활용한 자동화 ](https://www.notion.so/loinsir/Cloud-Function-aefc56628ef94051871c20c5b7429879?pvs=4) | Video |
|[Jenkins Pipeline 을 활용한 CI/CD 대작전](https://www.notion.so/loinsir/CI-CD-Jenknis-Pipeline-44ed0d4847dc4e8ca032ffcb04d5043c?pvs=4) | CI/CD |
|[NestJS Circular Dependency 문제..](https://www.notion.so/loinsir/Circular-Dependency-bcb283689d32401f80fbea5078568915?pvs=4) | NestJS |
|[🎈DB에 이모지를 저장할 줄 몰랐지..](https://www.notion.so/loinsir/b3874e5fcee54fcc890c44ccdfc05cb8?pvs=4) | DB |
|[log 남기기 대작전](https://www.notion.so/loinsir/with-discord-ncloud-6b06bef92ef44107b3a93cbe148cf512?pvs=4) | log |

<br>


**더 많은 내용은??** **-> [Team 코드폭격기 Wiki](https://github.com/boostcampwm2023/iOS09-Layover/wiki)**
